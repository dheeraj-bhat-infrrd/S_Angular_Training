<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

	<import resource="classpath:sscore-beans.xml" />
	<bean id="dataSource"
		class="org.springframework.jdbc.datasource.DriverManagerDataSource">
		<property name="url">
			<value>${DATABASE_URL}</value>
		</property>
		<property name="driverClassName">
			<value>com.mysql.jdbc.Driver</value>
		</property>
		<property name="username">
			<value>${DATABASE_USER}</value>
		</property>
		<property name="password">
			<value>${DATABASE_PASSWORD}</value>
		</property>
	</bean>

	<!-- setting site map generetor job detail -->
	<bean id="sitemapjobdetail"
		class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
		<property name="jobClass"
			value="com.realtech.socialsurvey.core.starter.ApplicationSiteMapGenerator" />
		<property name="jobDataAsMap">
			<map>
				<entry key="companySiteMapGenerator" value-ref="sitemapgenerator" />
				<entry key="regionSiteMapGenerator" value-ref="sitemapgenerator" />
				<entry key="branchSiteMapGenerator" value-ref="sitemapgenerator" />
				<entry key="agentSiteMapGenerator" value-ref="sitemapgenerator" />
				<entry key="uploadService" value-ref="uploadService" />
				<entry key="envPrefix" value="${AMAZON_ENV_PREFIX}" />
				<entry key="companySiteMapPath" value="${COMPANY_SITEMAP_PATH}" />
				<entry key="regionSiteMapPath" value="${REGION_SITEMAP_PATH}" />
				<entry key="branchSiteMapPath" value="${BRANCH_SITEMAP_PATH}" />
				<entry key="individualSiteMapPath" value="${INDIVIDUAL_SITEMAP_PATH}" />
			</map>
		</property>
		<property name="durability" value="true" />
	</bean>

	<!-- Setting incomplete social post reminder job detail -->
	<bean id="incompletesocialpostjobdetail"
		class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
		<property name="jobClass"
			value="com.realtech.socialsurvey.core.starter.IncompleteSocialPostReminderSender" />
		<property name="jobDataAsMap">
			<map>
				<entry key="urlGenerator" value-ref="urlGenerator" />
				<entry key="surveyHandler" value-ref="surveyHandler" />
				<entry key="emailServices" value-ref="emailServices" />
				<entry key="userManagementService" value-ref="userManagementService" />
				<entry key="socialManagementService" value-ref="socialManagementService" />
				<entry key="organizationManagementService" value-ref="organizationManagementService" />
			</map>
		</property>
		<property name="durability" value="true" />
	</bean>

	<!-- Setting incomplete survey reminder job detail -->
	<bean id="incompletesurveyjobdetail"
		class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
		<property name="jobClass"
			value="com.realtech.socialsurvey.core.starter.IncompleteSurveyReminderSender" />
		<property name="jobDataAsMap">
			<map>
				<entry key="surveyHandler" value-ref="surveyHandler" />
				<entry key="emailServices" value-ref="emailServices" />
				<entry key="userManagementService" value-ref="userManagementService" />
				<entry key="organizationManagementService" value-ref="organizationManagementService" />
				<entry key="emailFormatHelper" value-ref="emailFormatHelper" />
				<entry key="applicationBaseUrl" value="${APPLICATION_BASE_URL}" />
				<entry key="applicationLogoUrl" value="${APPLICATION_LOGO_URL}" />
			</map>
		</property>
		<property name="durability" value="true" />
	</bean>

	<!-- Setting update subscription price job detail -->
	<bean id="updatesubscriptionpricejobdetail"
		class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
		<property name="jobClass"
			value="com.realtech.socialsurvey.core.starter.UpdateSubscriptionPriceStarter" />
		<property name="jobDataAsMap">
			<map>
				<entry key="reviseSubscription" value-ref="reviseSubscription" />
			</map>
		</property>
		<property name="durability" value="true" />
	</bean>

	<!-- Setting social feed ingester job detail -->
	<bean id="socialfeedingesterjobdetail"
		class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
		<property name="jobClass"
			value="com.realtech.socialsurvey.core.starter.SocialFeedIngester" />
		<property name="jobDataAsMap">
			<map>
				<entry key="ingestor" value-ref="ingestor" />
			</map>
		</property>
		<property name="durability" value="true" />
	</bean>

	<!-- Setting email reader job detail -->
	<bean id="emailreaderjobdetail"
		class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
		<property name="jobClass"
			value="com.realtech.socialsurvey.core.starter.EmailReader" />
		<property name="jobDataAsMap">
			<map>
				<entry key="emailHandler" value-ref="emailHandler" />
			</map>
		</property>
		<property name="durability" value="true" />
	</bean>



	<!-- Account Deactivator job detail -->
	<bean id="accountdeactivatorjobdetail"
		class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
		<property name="jobClass"
			value="com.realtech.socialsurvey.core.starter.AccountDeactivator" />
		<property name="jobDataAsMap">
			<map>
				<entry key="organizationManagementService" value-ref="organizationManagementService" />
				<entry key="solrSearchService" value-ref="solrSearchService" />
				<entry key="emailServices" value-ref="emailServices" />
			</map>
		</property>
		<property name="durability" value="true" />
	</bean>

	<!-- Deactivated Account Purger job detail -->
	<bean id="deactivatedaccountpurgerjobdetail"
		class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
		<property name="jobClass"
			value="com.realtech.socialsurvey.core.starter.DeactivatedAccountPurger" />
		<property name="jobDataAsMap">
			<map>
				<entry key="organizationManagementService" value-ref="organizationManagementService" />
				<entry key="emailServices" value-ref="emailServices" />
				<entry key="solrSearchService" value-ref="solrSearchService" />
				<entry key="accountPermDeleteSpan" value="${ACCOUNT_PERM_DELETE_SPAN}" />
			</map>
		</property>
		<property name="durability" value="true" />
	</bean>

	<!-- Deactivated Account Purger job detail -->
	<bean id="crmdataagentidmapperjobdetail"
		class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
		<property name="jobClass"
			value="com.realtech.socialsurvey.core.starter.CrmDataAgentIdMapper" />
		<property name="jobDataAsMap">
			<map>
				<entry key="emailServices" value-ref="emailServices" />
				<entry key="surveyHandler" value-ref="surveyHandler" />
				<entry key="userManagementService" value-ref="userManagementService" />
				<entry key="companyAdminEnabled" value="${BATCH_COMPANY_ADMIN_ENABLED}" />
				<entry key="adminEmailId" value="${APPLICATION_ADMIN_EMAIL}" />
				<entry key="adminName" value="${APPLICATION_ADMIN_NAME}" />
				<entry key="fileDirectoryLocation" value="${FILE_DIRECTORY_LOCATION}" />
			</map>
		</property>
		<property name="durability" value="true" />
	</bean>

	<!-- Image loader job detail -->
	<bean id="imageloaderjobdetail"
		class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
		<property name="jobClass"
			value="com.realtech.socialsurvey.core.starter.ImageLoader" />
		<property name="jobDataAsMap">
			<map>
				<entry key="fileUploadService" value-ref="fileUploadService" />
				<entry key="profileManagementService" value-ref="profileManagementService" />
				<entry key="organizationManagementService" value-ref="organizationManagementService" />
				<entry key="amazonImageBucket" value="${AMAZON_IMAGE_BUCKET}" />
				<entry key="cdnUrl" value="${CDN_PATH}" />
			</map>
		</property>
		<property name="durability" value="true" />
	</bean>

	<!-- Setting file upload job detail -->
	<bean id="fileuploadjobdetail"
		class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
		<property name="jobClass"
			value="com.realtech.socialsurvey.core.starter.CSVHierarchyUploader" />
		<property name="jobDataAsMap">
			<map>
				<entry key="uploadHandler" value-ref="uploadHandler" />
			</map>
		</property>
		<property name="durability" value="true" />
	</bean>

	<!-- Setting zillow job detail -->
	<!-- <bean id="zillowjobdetail" class="org.springframework.scheduling.quartz.JobDetailFactoryBean"> 
		<property name="jobClass" value="com.realtech.socialsurvey.core.starter.ZillowReviewProcessor" 
		/> <property name="jobDataAsMap"> <map> <entry key="zws-id" value="${ZILLOW_WEBSERVICE_ID}" 
		/> <entry key="zillowIntegrationApiBuilder" value-ref="zillowIntegrationApiBuilder" 
		/> <entry key="organizationManagementService" value-ref="organizationManagementService" 
		/> <entry key="surveyHandler" value-ref="surveyHandler" /> </map> </property> 
		<property name="durability" value="true" /> </bean> -->

	<bean id="hierarchysettingsjobdetail"
		class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
		<property name="jobClass"
			value="com.realtech.socialsurvey.core.starter.HierarchySettingsCorrector" />
		<property name="jobDataAsMap">
			<map>
				<entry key="organizationManagementService" value-ref="organizationManagementService" />
			</map>
		</property>
		<property name="durability" value="true" />
	</bean>


	<!-- Setting dotloop job detail -->
	<bean id="dotloopjobdetail"
		class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
		<property name="jobClass"
			value="com.realtech.socialsurvey.core.starter.DotloopReviewProcessor" />
		<property name="jobDataAsMap">
			<map>
				<entry key="dotloopIntegrationApiBuilder" value-ref="dotloopIntegrationApiBuilder" />
				<entry key="organizationManagementService" value-ref="organizationManagementService" />
				<entry key="userManagementService" value-ref="userManagementService" />
				<entry key="surveyHandler" value-ref="surveyHandler" />
			</map>
		</property>
		<property name="durability" value="true" />
	</bean>


	<!-- setting cron for Account deactivator -->
	<bean id="sitemapgeneratorcron"
		class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
		<property name="jobDetail" ref="sitemapjobdetail" />
		<property name="cronExpression" value="0 0 * * * ?" />
	</bean>

	<!-- setting cron for incomplete social post reminder -->
	<bean id="incompletesocialpostcron"
		class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
		<property name="jobDetail" ref="incompletesocialpostjobdetail" />
		<property name="cronExpression" value="0 0 6 * * ?" />
	</bean>

	<!-- setting cron for incomplete survey reminder -->
	<bean id="incompletesurveycron"
		class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
		<property name="jobDetail" ref="incompletesurveyjobdetail" />
		<property name="cronExpression" value="0 06 * * * ?" />
	</bean>

	<!-- setting cron for update subscription price -->
	<bean id="updatesubscriptionpricecron"
		class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
		<property name="jobDetail" ref="updatesubscriptionpricejobdetail" />
		<property name="cronExpression" value="0 30 6 * * ?" />
	</bean>

	<!-- setting cron for social feed ingester -->
	<bean id="socialfeedingestercron"
		class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
		<property name="jobDetail" ref="socialfeedingesterjobdetail" />
		<property name="cronExpression" value="0 0 19,20,21,22,23,0,1,2,3,4,5,6,7 * * ?" />
	</bean>

	<!-- setting cron for email reader -->
	<bean id="emailreadercron"
		class="org.springframework.scheduling.quartz.SimpleTriggerFactoryBean">
		<property name="jobDetail" ref="emailreaderjobdetail" />
		<property name="repeatCount" value="0" />
		<property name="startDelay" value="1000" />
		<!-- <property name="cronExpression" value="0 0/1 * * * ?" /> -->
	</bean>


	<bean id="hierarchysettingscron"
		class="org.springframework.scheduling.quartz.SimpleTriggerFactoryBean">
		<property name="jobDetail" ref="hierarchysettingsjobdetail" />
		<property name="repeatCount" value="0" />
		<property name="startDelay" value="1000" />
	</bean>



	<!-- setting cron for account deactivator -->
	<bean id="accountdeactivatorcron"
		class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
		<property name="jobDetail" ref="accountdeactivatorjobdetail" />
		<property name="cronExpression" value="0 0 7 * * ?" />
	</bean>

	<!-- setting cron for deactivated account purger -->
	<bean id="deactivatedaccountpurgercron"
		class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
		<property name="jobDetail" ref="deactivatedaccountpurgerjobdetail" />
		<property name="cronExpression" value="0 15 7 * * ?" />
	</bean>

	<!-- setting cron for mapping crm data agent id -->
	<bean id="crmdataagentidmappercron"
		class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
		<property name="jobDetail" ref="crmdataagentidmapperjobdetail" />
		<property name="cronExpression" value="0 05 * * * ?" />
	</bean>

	<!-- setting cron for loading image from linkedin to amazon server -->
	<bean id="imageloadercron"
		class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
		<property name="jobDetail" ref="imageloaderjobdetail" />
		<property name="cronExpression" value="0 45 7 * * ?" />
	</bean>

	<!-- setting cron for email reader -->
	<bean id="fileuploadcron"
		class="org.springframework.scheduling.quartz.SimpleTriggerFactoryBean">
		<property name="jobDetail" ref="fileuploadjobdetail" />
		<property name="repeatCount" value="0" />
		<property name="startDelay" value="2000" />
	</bean>

	<bean id="dotloopcron"
		class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
		<property name="jobDetail" ref="dotloopjobdetail" />
		<property name="cronExpression" value="0 0 1 * * ?" />
	</bean>


	<!-- setting cron for loading image from linkedin to amazon server -->
	<!-- <bean id="zillowcron" class="org.springframework.scheduling.quartz.CronTriggerFactoryBean"> 
		<property name="jobDetail" ref="zillowjobdetail" /> <property name="cronExpression" 
		value="0 25 0,2,4,6,8,10,12,14,16,18,20,22 * * ?" /> </bean> -->

	<!-- Scheduler factory -->
	<bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
		<property name="jobDetails">
			<list>
				<ref bean="sitemapjobdetail" />
				<ref bean="emailreaderjobdetail" />
				<ref bean="incompletesocialpostjobdetail" />
				<ref bean="incompletesurveyjobdetail" />
				<ref bean="updatesubscriptionpricejobdetail" />
				<ref bean="socialfeedingesterjobdetail" />
				<ref bean="accountdeactivatorjobdetail" />
				<ref bean="deactivatedaccountpurgerjobdetail" />
				<ref bean="crmdataagentidmapperjobdetail" />
				<ref bean="imageloaderjobdetail" />
				<ref bean="fileuploadjobdetail" />
				<ref bean="hierarchysettingsjobdetail" />
				<ref bean="dotloopjobdetail" />
				<!-- <ref bean="zillowjobdetail" /> -->
			</list>
		</property>

		<property name="triggers">
			<list>
				<ref bean="sitemapgeneratorcron" />
				<ref bean="emailreadercron" />
				<ref bean="incompletesocialpostcron" />
				<ref bean="incompletesurveycron" />
				<ref bean="updatesubscriptionpricecron" />
				<ref bean="socialfeedingestercron" />
				<ref bean="accountdeactivatorcron" />
				<ref bean="deactivatedaccountpurgercron" />
				<ref bean="crmdataagentidmappercron" />
				<ref bean="imageloadercron" />
				<ref bean="fileuploadcron" />
				<ref bean="hierarchysettingscron" />
				<ref bean="dotloopcron" />
				<!-- <ref bean="zillowcron" /> -->
			</list>
		</property>
		<property name="quartzProperties">
			<props>
				<prop key="org.quartz.threadPool.threadCount">1</prop>
			</props>
		</property>
	</bean>


	<!-- Bean definitions -->
	<!-- Site map generetor dependencies -->
	<bean id="sitemapgenerator"
		class=" com.realtech.socialsurvey.core.utils.sitemap.SiteMapGenerator"
		scope="prototype" />
	<bean id="uploadService"
		class="com.realtech.socialsurvey.core.services.upload.impl.CloudUploadServiceImpl" />

	<!-- Incomplete survey reminder and social post reminder dependencies -->
	<bean id="urlGenerator"
		class="com.realtech.socialsurvey.core.services.generator.impl.UrlGeneratorImpl" />
	<bean id="surveyHandler"
		class="com.realtech.socialsurvey.core.services.surveybuilder.impl.SurveyHandlerImpl" />
	<bean id="emailServices"
		class="com.realtech.socialsurvey.core.services.mail.impl.EmailServicesImpl" />
	<bean id="userManagementService"
		class="com.realtech.socialsurvey.core.services.organizationmanagement.impl.UserManagementServiceImpl" />
	<bean id="zillowIntegrationApiBuilder"
		class="com.realtech.socialsurvey.core.integration.zillow.ZillowIntergrationApiBuilder" />
	<bean id="organizationManagementService"
		class="com.realtech.socialsurvey.core.services.organizationmanagement.impl.OrganizationManagementServiceImpl" />
	<bean id="solrSearchService"
		class="com.realtech.socialsurvey.core.services.search.impl.SolrSearchServiceImpl" />

	<!-- Update subscription dependencies -->
	<bean id="reviseSubscription"
		class="com.realtech.socialsurvey.core.starter.ReviseSubscriptionPrice" />

	<!-- Social feed ingestor dependencies -->
	<bean id="ingestor"
		class="com.realtech.socialsurvey.core.feed.impl.SocialFeedIngestionKickStarter" />
	<!-- Email reader -->
	<bean id="emailHandler" class="com.realtech.socialsurvey.core.handler.EmailHandler" />


	<bean id="surveyGenerationService"
		class="com.realtech.socialsurvey.core.dummy.generator.SurveyGenerationServiceImpl" />
	<bean id="surveyBuilder"
		class="com.realtech.socialsurvey.core.services.surveybuilder.impl.SurveyBuilderImpl" />
	<bean id="socialManagementService"
		class="com.realtech.socialsurvey.core.services.social.impl.SocialManagementServiceImpl" />
	<bean id="fileUploadService"
		class="com.realtech.socialsurvey.core.services.upload.impl.CloudUploadServiceImpl" />
	<bean id="profileManagementService"
		class="com.realtech.socialsurvey.core.services.organizationmanagement.impl.ProfileManagementServiceImpl" />
	<bean id="dotloopIntegrationApiBuilder"
	class="com.realtech.socialsurvey.core.integration.dotloop.DotloopIntergrationApiBuilder" />
	<bean id="regionsFullImport"
		class="com.realtech.socialsurvey.core.utils.solr.RegionsFullImport" />
	<bean id="branchesFullImport"
		class="com.realtech.socialsurvey.core.utils.solr.BranchesFullImport" />
	<bean id="usersFullImport"
		class="com.realtech.socialsurvey.core.utils.solr.UsersFullImport" />


	<!-- Posts to wall -->
	<bean id="postToWall" class="com.realtech.socialsurvey.core.utils.mongo.PostToWall" />

	<!-- Email reader -->
	<bean id="uploadHandler" class="com.realtech.socialsurvey.core.handler.CSVUploadHandler" />
</beans>